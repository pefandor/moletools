---
import Layout from '../../layouts/Layout.astro';
import toolsData from '../../data/tools.json';

const tool = toolsData.find(t => t.id === 'lorem-ipsum');
const title = tool?.metaTitle || 'Lorem Ipsum Generator';
const description = tool?.metaDescription || 'Generate placeholder Lorem Ipsum text';

// JSON-LD Schema
const jsonLd = {
  '@context': 'https://schema.org',
  '@graph': [
    {
      '@type': 'WebApplication',
      name: tool?.name || 'Lorem Ipsum Generator',
      applicationCategory: 'UtilitiesApplication',
      operatingSystem: 'Any',
      description: tool?.metaDescription || description,
      offers: {
        '@type': 'Offer',
        price: '0',
        priceCurrency: 'USD'
      }
    },
    {
      '@type': 'FAQPage',
      mainEntity: (tool?.faq || []).map(item => ({
        '@type': 'Question',
        name: item.question,
        acceptedAnswer: {
          '@type': 'Answer',
          text: item.answer
        }
      }))
    }
  ]
};
---

<Layout title={title} description={description}>
  <script type="application/ld+json" set:html={JSON.stringify(jsonLd)} />

  <div class="max-w-4xl mx-auto">
    <div class="mb-8">
      <h1 class="text-4xl font-bold text-gray-900 dark:text-gray-100 mb-4">
        {tool?.icon} {tool?.name || 'Lorem Ipsum Generator'}
      </h1>
      <p class="text-lg text-gray-600 dark:text-gray-400">
        {tool?.description || 'Generate placeholder Lorem Ipsum text'}
      </p>
    </div>

    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-6">
      <!-- Options -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Type</label>
          <select
            id="type-select"
            class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-gray-100"
          >
            <option value="paragraphs">Paragraphs</option>
            <option value="sentences">Sentences</option>
            <option value="words">Words</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Count</label>
          <input
            type="number"
            id="count-input"
            value="3"
            min="1"
            max="20"
            class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-gray-100"
          />
        </div>
      </div>

      <div class="mb-4">
        <label class="flex items-center">
          <input
            type="checkbox"
            id="start-classic"
            checked
            class="w-4 h-4 text-primary-600 dark:text-primary-400 border-gray-300 dark:border-gray-600 rounded focus:ring-primary-500"
          />
          <span class="ml-2 text-sm text-gray-700">Start with "Lorem ipsum dolor sit amet..."</span>
        </label>
      </div>

      <!-- Buttons -->
      <div class="flex gap-2 mb-4">
        <button
          id="generate-btn"
          class="px-6 py-2 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 transition-colors"
        >
          Generate
        </button>
        <button
          id="copy-btn"
          class="px-6 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 font-medium rounded-lg hover:bg-gray-200 dark:bg-gray-600 transition-colors"
        >
          ðŸ“‹ Copy
        </button>
      </div>

      <!-- Output -->
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Generated Text</label>
        <textarea
          id="output"
          rows="12"
          readonly
          class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 font-mono text-sm resize-y"
          placeholder="Click Generate to create Lorem Ipsum text..."
        ></textarea>
      </div>
    </div>

    <!-- FAQ Section -->
    {tool?.faq && tool.faq.length > 0 && (
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-6">
        <h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4">Frequently Asked Questions</h2>
        <div class="space-y-4">
          {tool.faq.map((item) => (
            <div>
              <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2">{item.question}</h3>
              <p class="text-gray-600 dark:text-gray-400">{item.answer}</p>
            </div>
          ))}
        </div>
      </div>
    )}
  </div>

  <script>
    (function() {
      var typeSelect = document.getElementById('type-select');
      var countInput = document.getElementById('count-input');
      var startClassic = document.getElementById('start-classic');
      var generateBtn = document.getElementById('generate-btn');
      var copyBtn = document.getElementById('copy-btn');
      var output = document.getElementById('output');

      // Lorem Ipsum word dictionary
      var loremWords = [
        'lorem', 'ipsum', 'dolor', 'sit', 'amet', 'consectetur', 'adipiscing', 'elit',
        'sed', 'do', 'eiusmod', 'tempor', 'incididunt', 'ut', 'labore', 'et', 'dolore',
        'magna', 'aliqua', 'enim', 'ad', 'minim', 'veniam', 'quis', 'nostrud',
        'exercitation', 'ullamco', 'laboris', 'nisi', 'aliquip', 'ex', 'ea', 'commodo',
        'consequat', 'duis', 'aute', 'irure', 'in', 'reprehenderit', 'voluptate',
        'velit', 'esse', 'cillum', 'fugiat', 'nulla', 'pariatur', 'excepteur', 'sint',
        'occaecat', 'cupidatat', 'non', 'proident', 'sunt', 'culpa', 'qui', 'officia',
        'deserunt', 'mollit', 'anim', 'id', 'est', 'laborum', 'semper', 'quis', 'lectus',
        'nulla', 'at', 'volutpat', 'diam', 'maecenas', 'ultricies', 'mi', 'eget',
        'mauris', 'pharetra', 'odio', 'facilisis', 'gravida', 'neque', 'convallis',
        'posuere', 'morbi', 'leo', 'urna', 'vitae', 'turpis', 'massa', 'tincidunt',
        'nunc', 'pulvinar', 'sapien', 'ligula', 'risus', 'feugiat', 'vivamus', 'arcu',
        'felis', 'bibendum', 'erat', 'venenatis', 'fringilla', 'vel', 'aliquet', 'nec',
        'vulputate', 'pellentesque', 'habitant', 'tristique', 'senectus', 'malesuada',
        'fames', 'ac', 'egestas', 'cursus', 'integer', 'enim', 'euismod', 'elementum',
        'facilisi', 'etiam', 'dignissim', 'suspendisse', 'potenti', 'nullam', 'porttitor',
        'lacus', 'luctus', 'accumsan', 'tortor', 'posuere', 'viverra', 'tellus'
      ];

      var classicStart = 'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.';

      function getRandomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }

      function getRandomWord() {
        return loremWords[getRandomInt(0, loremWords.length - 1)];
      }

      function generateWords(count) {
        var words = [];
        for (var i = 0; i < count; i++) {
          words.push(getRandomWord());
        }
        return words.join(' ');
      }

      function generateSentence() {
        var wordCount = getRandomInt(8, 16);
        var words = [];
        for (var i = 0; i < wordCount; i++) {
          words.push(getRandomWord());
        }
        var sentence = words.join(' ');
        return sentence.charAt(0).toUpperCase() + sentence.slice(1) + '.';
      }

      function generateParagraph() {
        var sentenceCount = getRandomInt(4, 8);
        var sentences = [];
        for (var i = 0; i < sentenceCount; i++) {
          sentences.push(generateSentence());
        }
        return sentences.join(' ');
      }

      function generateText() {
        var type = typeSelect.value;
        var count = parseInt(countInput.value) || 3;
        var useClassicStart = startClassic.checked;
        var result = [];

        if (type === 'paragraphs') {
          if (useClassicStart) {
            result.push(classicStart);
            count--;
          }
          for (var i = 0; i < count; i++) {
            result.push(generateParagraph());
          }
          return result.join('\n\n');
        } else if (type === 'sentences') {
          if (useClassicStart) {
            result.push(classicStart);
            count--;
          }
          for (var i = 0; i < count; i++) {
            result.push(generateSentence());
          }
          return result.join(' ');
        } else if (type === 'words') {
          if (useClassicStart) {
            var classicWords = classicStart.replace('.', '').split(' ');
            result = classicWords.slice(0, Math.min(count, classicWords.length));
            count -= result.length;
            if (count > 0) {
              result.push(generateWords(count));
            }
            return result.join(' ');
          } else {
            return generateWords(count);
          }
        }
      }

      // Event listeners
      if (generateBtn) {
        generateBtn.addEventListener('click', function() {
          output.value = generateText();
        });
      }

      if (copyBtn) {
        copyBtn.addEventListener('click', function() {
          if (output.value) {
            navigator.clipboard.writeText(output.value);
            copyBtn.textContent = 'âœ“ Copied';
            setTimeout(function() { copyBtn.textContent = 'ðŸ“‹ Copy'; }, 2000);
          }
        });
      }

      // Update count limits based on type
      if (typeSelect) {
        typeSelect.addEventListener('change', function() {
          if (typeSelect.value === 'words') {
            countInput.max = '1000';
          } else {
            countInput.max = '20';
            if (parseInt(countInput.value) > 20) {
              countInput.value = '20';
            }
          }
        });
      }

      // Generate on load
      if (output) {
        output.value = generateText();
      }
    })();
  </script>
</Layout>
